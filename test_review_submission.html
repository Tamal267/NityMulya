<!DOCTYPE html>
<html>
<head>
    <title>Review Submission Test</title>
    <meta charset="UTF-8">
</head>
<body>
    <h1>Review Submission Test</h1>
    <div id="results"></div>

    <script>
        const baseUrl = 'http://localhost:3001';
        const resultsDiv = document.getElementById('results');

        function addResult(title, data) {
            const div = document.createElement('div');
            div.innerHTML = `<h3>${title}</h3><pre>${JSON.stringify(data, null, 2)}</pre><hr>`;
            resultsDiv.appendChild(div);
        }

        // Test review submission
        async function testReviewSubmission() {
            try {
                addResult('Testing Review Submission API...', { message: 'Starting test...' });

                const reviewData = {
                    customerId: 'test-customer-123',
                    shopOwnerId: 'test-shop-123',
                    rating: 5,
                    comment: 'এটি একটি টেস্ট রিভিউ - খুবই ভালো পণ্য!',
                    productName: 'ময়দা (খোলা)',
                    shopName: 'টেস্ট শপ',
                    isVerifiedPurchase: true
                };

                console.log('Submitting review:', reviewData);

                const response = await fetch(`${baseUrl}/reviews/create`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(reviewData)
                });

                const result = await response.json();
                addResult('Review Submission Response', result);

                if (result.success) {
                    // Now test getting the reviews back
                    const productName = encodeURIComponent('ময়দা (খোলা)');
                    const getResponse = await fetch(`${baseUrl}/reviews/product/${productName}`);
                    const getResult = await getResponse.json();
                    addResult('Get Reviews After Submission', getResult);
                }

            } catch (error) {
                addResult('Error', { error: error.message, stack: error.stack });
            }
        }

        // Run tests when page loads
        window.onload = testReviewSubmission;
    </script>
</body>
</html>
